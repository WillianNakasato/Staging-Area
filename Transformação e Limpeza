#Transformação ou Limpeza ////////////////////////////////////////////////////

--ST_CADASTRO_CLIENTE--

SELECT

*

FROM ST_CADASTRO_CLIENTE

ALTER TABLE ST_CADASTRO_CLIENTE ADD (DATA_CADASTRO DATE);

UPDATE ST_CADASTRO_CLIENTE
SET DATA_CADASTRO = CURRENT_DATE;
COMMIT;

UPDATE ST_CADASTRO_CLIENTE 
SET EMAIL_CLIENTE = (NOME_CLIENTE || '@gmail.com') where email_cliente is null;
COMMIT;

UPDATE ST_CADASTRO_CLIENTE 
SET EMAIL_CLIENTE = (NOME_CLIENTE || '@gmail.com') where substr(email_cliente, 1, 3) = 'xxx';
COMMIT;



#Cria uma função para saber quando temos um valor numérico

CREATE FUNCTION is_numeric( i IN VARCHAR2 )
  RETURN NUMBER
IS
  l_num NUMBER;
BEGIN
  l_num := to_number( i );
  RETURN 1;
EXCEPTION
  WHEN value_error
  THEN
    RETURN 0;
END;

UPDATE ST_CADASTRO_CLIENTE 
SET EMAIL_CLIENTE = (NOME_CLIENTE || '@gmail.com') where is_numeric(email_cliente) = 1;
COMMIT;
